{
  "version": 3,
  "file": "pkg-json.js",
  "sourceRoot": "..\\..\\",
  "sources": [
    "src\\lib\\pkg-json.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# pkg-json.coffee\r\n\r\nimport {\r\n\tundef, defined, notdefined, isEmpty, nonEmpty, hasKey,\r\n\tassert, croak, OL, getOptions,\r\n\t} from '@jdeighan/llutils'\r\nimport {\r\n\tslurpPkgJSON, slurpJSON, barfJSON, barfPkgJSON,\r\n\t} from '@jdeighan/llutils/fs'\r\n\r\n# ---------------------------------------------------------------------------\r\n# --- 1. Read in current package.json\r\n#     2. If option 'fix':\r\n#        - get keys from env var PROJECT_PACKAGE_JSON\r\n#        - overwrite keys in package.json\r\n#        - adjust name if env var PROJECT_NAME_PREFIX is set\r\n\r\nexport class PkgJson\r\n\r\n\tconstructor: (hOptions={}) ->\r\n\r\n\t\t{fix} = getOptions hOptions, {\r\n\t\t\tfix: false\r\n\t\t\t}\r\n\t\t@hJson = slurpPkgJSON()\r\n\t\tif fix\r\n\t\t\t@mergeKeysFromEnv()\r\n\t\t\tprefix = process.env.PROJECT_NAME_PREFIX\r\n\t\t\tif nonEmpty(prefix) && ! @name.startsWith(prefix)\r\n\t\t\t\t@setField 'name', \"#{prefix}#{@hJson.name}\"\r\n\t\t\t@setField 'license', 'MIT'\r\n\t\t\t@addDep '@jdeighan/llutils'\r\n\r\n\t# ..........................................................\r\n\r\n\tmergeKeysFromEnv: () ->\r\n\r\n\t\tpkgJson = process.env.PROJECT_PACKAGE_JSON\r\n\t\tif nonEmpty(pkgJson)\r\n\t\t\t# --- Can be either a JSON string or a file path\r\n\t\t\tif (pkgJson.indexOf('{') == 0)\r\n\t\t\t\thSetKeys = JSON.parse(pkgJson)\r\n\t\t\telse\r\n\t\t\t\thSetKeys = slurpJSON(pkgJson)\r\n\t\t\tObject.assign @hJson, hSetKeys\r\n\t\treturn\r\n\r\n\t# ..........................................................\r\n\r\n\tname: () ->\r\n\r\n\t\treturn @hJson.name\r\n\r\n\t# ..........................................................\r\n\r\n\tgetField: (name) ->\r\n\r\n\t\treturn @hJson[name]\r\n\r\n\t# ..........................................................\r\n\r\n\tsetField: (name, value) ->\r\n\r\n\t\t@hJson[name] = value\r\n\t\tconsole.log \"   #{name} = #{OL(value)}\"\r\n\t\treturn\r\n\r\n\t# ..........................................................\r\n\r\n\taddScript: (name, str) ->\r\n\r\n\t\tif ! hasKey(@hJson, 'scripts')\r\n\t\t\t@hJson.scripts = {}\r\n\t\t@hJson.scripts[name] = str\r\n\t\tconsole.log \"   SCRIPT #{name} = #{OL(str)}\"\r\n\t\treturn\r\n\r\n\t# ..........................................................\r\n\r\n\taddExport: (name, str) ->\r\n\r\n\t\tif ! hasKey(@hJson, 'exports')\r\n\t\t\t@hJson.exports = {}\r\n\t\t@hJson.exports[name] = str\r\n\t\tconsole.log \"   EXPORT #{name} = #{OL(str)}\"\r\n\t\treturn\r\n\r\n\t# ..........................................................\r\n\r\n\taddBin: (name, str) ->\r\n\r\n\t\tif ! hasKey(@hJson, 'bin')\r\n\t\t\t@hJson.bin = {}\r\n\t\t@hJson.bin[name] = str\r\n\t\tconsole.log \"   BIN #{name} = #{OL(str)}\"\r\n\t\treturn\r\n\r\n\t# ..........................................................\r\n\r\n\taddDep: (pkg) ->\r\n\r\n\t\tif ! hasKey(@hJson, 'dependencies')\r\n\t\t\t@hJson.dependencies = {}\r\n\t\tif @hJson?.devDependencies?.pkg\r\n\t\t\tdelete @hJson.devDependencies.pkg\r\n\t\tversion = getVersion(pkg)\r\n\t\t@hJson.dependencies[pkg] = version\r\n\t\tconsole.log \"   DEP #{pkg} = #{OL(version)}\"\r\n\t\treturn\r\n\r\n\t# ..........................................................\r\n\r\n\taddDevDep: (pkg) ->\r\n\r\n\t\tif ! hasKey(@hJson, 'devDependencies')\r\n\t\t\t@hJson.devDependencies = {}\r\n\t\tif @hJson?.dependencies.pkg\r\n\t\t\tdelete @hJson.dependencies.pkg\r\n\t\tversion = getVersion(pkg)\r\n\t\t@hJson.devDependencies[pkg] = version\r\n\t\tconsole.log \"   DEV DEP #{pkg} = #{OL(version)}\"\r\n\t\treturn\r\n\r\n\t# ..........................................................\r\n\r\n\tisInstalled: (pkg) ->\r\n\r\n\t\treturn hasKey(@hJson.dependencies, pkg) \\\r\n\t\t\t\t|| hasKey(@hJson.devDependencies, pkg)\r\n\r\n\t# ..........................................................\r\n\r\n\twrite: () ->\r\n\r\n\t\tbarfPkgJSON @hJson\r\n\t\treturn\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\ngetVersion = (pkg) =>\r\n\r\n\tswitch pkg\r\n\t\twhen 'coffeescript'\r\n\t\t\treturn \"^2.7.0\"\r\n\t\twhen 'ava'\r\n\t\t\treturn \"^6.1.3\"\r\n\t\twhen 'svelte'\r\n\t\t\treturn \"^5.0.0-next.200\"\r\n\t\twhen 'gulp'\r\n\t\t\treturn \"^5.0.0\"\r\n\t\twhen 'parcel'\r\n\t\t\treturn \"^2.12.0\"\r\n\t\telse\r\n\t\t\treturn 'latest'\r\n\r\n"
  ]
}