{
  "version": 3,
  "file": "exec-utils.js",
  "sourceRoot": "..\\..\\",
  "sources": [
    "src\\lib\\exec-utils.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# exec-utils.coffee\r\n\r\nimport {exec, execSync} from 'node:child_process'\r\nimport vm from 'node:vm'\r\nimport {promisify} from 'node:util'\r\nexecAsync = promisify(exec)\r\n\r\nimport {\r\n\tundef, defined, notdefined, getOptions, chomp,\r\n\tassert, croak, OL, stripCR, isEmpty,\r\n\t} from '@jdeighan/llutils'\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport execCmd = (cmdLine, hOptions={}) =>\r\n\t# --- may throw an exception\r\n\r\n\thOptions.encoding = 'utf8'\r\n\thOptions.windowsHide = true\r\n\thOptions.timeout = 100000\r\n\r\n\tresult = execSync(cmdLine, hOptions)\r\n\tassert defined(result), \"undef return from execSync()\"\r\n\tresult = result.toString()\r\n\tassert defined(result), \"undef return from toString()\"\r\n\treturn stripCR(result)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport execCmdY = (cmdLine, hOptions={}) =>\r\n\r\n\thOptions.input = \"y\\r\\n\"\r\n\treturn execCmd cmdLine, hOptions\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport execAndLogCmd = (cmdLine, hOptions={}) =>\r\n\t# --- may throw an exception\r\n\r\n\thOptions = getOptions hOptions, {\r\n\t\tencoding: 'utf8'\r\n\t\twindowsHide: true\r\n\t\t}\r\n\tresult = execSync(cmdLine, hOptions).toString()\r\n\tconsole.log result\r\n\treturn result\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport execCmdAsync = (cmdLine, hOptions={}) =>\r\n\t# --- may throw an exception\r\n\r\n\thOptions = getOptions hOptions, {\r\n\t\tencoding: 'utf8'\r\n\t\twindowsHide: true\r\n\t\t}\r\n\treturn execAsync(cmdLine, hOptions)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport npmLogLevel = () =>\r\n\r\n\tresult = execCmd('npm config get loglevel')\r\n\treturn chomp(result)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport checkJS = (code, fileName=undef) =>\r\n\r\n\tscript = new vm.Script(code, fileName)\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport checkJSFile = (filePath) =>\r\n\r\n\tresult = execCmd \"node -c #{filePath}\"\r\n\tassert isEmpty(result), \"ERROR: #{result}\"\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n# --- returns result of last statement executed\r\n\r\nexport execJS = (jsCode, fileName=undef) =>\r\n\r\n\tvm.runInThisContext(jsCode, {displayErrors: true})\r\n\r\n\tscript = new vm.Script(jsCode, {filename: fileName})\r\n\treturn script.runInThisContext()\r\n"
  ]
}